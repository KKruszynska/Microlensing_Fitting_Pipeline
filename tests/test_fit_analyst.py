import pytest

import numpy as np
import json
from collections import OrderedDict

from MFPipeline import logs

scenario_gaia = {
        "path_outputs": "tests/test_cmd/output/",
        "event_name": "GDR3-ULENS-025",
        "ra": 260.8781,
        "dec": -27.3788,
        "fit_analyst": {
            "n_max" : 5,
            "fitting_package": "pyLIMA"
        },
        "light_curves" : [
            {
            "survey": "Gaia",
            "band": "G",
            "lc" : [[2456910.4676960483, 16.119647097397866, 0.024182109480500265], [2456944.097920084, 16.1281994879945, 0.024102478488337693], [2456944.1719414876, 16.1285359626727, 0.02419777467055903], [2457078.3890062636, 16.120357072333967, 0.02403471865678973], [2457078.463020536, 16.134760710966667, 0.024505304034794853], [2457107.878045984, 16.116736630569648, 0.02424988674596031], [2457107.952060067, 16.115967187433412, 0.024124044205778204], [2457129.1305468855, 16.132024663147845, 0.024318708043387052], [2457267.912960924, 16.098216809354827, 0.023799038017496735], [2457300.391961907, 16.079130401744436, 0.023866983792220856], [2457318.4670760017, 16.07142315914993, 0.023531813749123318], [2457318.643198729, 16.069144840302208, 0.023722670344479765], [2457453.9383531422, 14.99055127279246, 0.015404419381658476], [2457488.670021793, 14.365753774551392, 0.012093605935530037], [2457488.744034871, 14.37452149829206, 0.012726113407297016], [2457502.6764832777, 14.48665896919324, 0.012734657594140235], [2457502.750467077, 14.513437777084865, 0.012868771372960946], [2457502.9266667766, 14.505492127551664, 0.012860206858602782], [2457643.7846181365, 15.890986967584114, 0.022106032161524777], [2457681.5051815296, 16.01045739488919, 0.02319143808075375], [2457681.681346247, 16.011106502385413, 0.023357456047075995], [2457681.755325464, 16.003154676154338, 0.02295600668208681], [2457690.935386812, 16.02487106200895, 0.023130464027282093], [2457691.0093671656, 16.027657718224443, 0.02316789500337163], [2457691.185513397, 16.030648484337213, 0.023164879093566362], [2457691.259516285, 16.027504606626724, 0.023199287644348036], [2457782.0772555578, 16.115588639544, 0.024165096227882318], [2457782.2533991826, 16.1185065357121, 0.02398959735430794], [2457782.327439331, 16.10987710488869, 0.024123913508031773], [2457793.890539446, 16.10602811118399, 0.02394877816643231], [2457794.066712325, 16.108900610438045, 0.024109721829405222], [2457794.140726579, 16.11220545102374, 0.023942914094808997], [2457829.545259242, 16.121608265363125, 0.024085050752152042]],
            },
            {
                "survey": "Gaia",
                "band": "BP",
                "lc": [[2456910.4680109997, 17.731966728974463, 0.2385655986167379], [2456944.098234465, 17.809826248222045, 0.22171800712842799], [2456944.1722349133, 17.72254007920538, 0.31209754575449195], [2457078.389321297, 17.769989911451425, 0.25238182512785773], [2457078.4633350107, 17.843562035094696, 0.24994489502700412], [2457107.878360783, 17.792961439532426, 0.22462151894719967], [2457107.952375094, 17.795132631349112, 0.26903542203493025], [2457267.913275357, 17.749619922520946, 0.2309253025992069], [2457300.3922552997, 17.812130266642708, 0.45824481817470053], [2457318.4673902676, 17.773838369225842, 0.31971731956954247], [2457318.643534822, 17.720804245500922, 0.22697464617680968], [2457453.938667542, 16.679526539375118, 0.11707917179103021], [2457488.6703365473, 16.008466225119655, 0.10481645099308214], [2457488.744349812, 16.05022893706441, 0.0793091922629137], [2457502.6767982924, 16.185477708057693, 0.09998541979907677], [2457502.7508099442, 16.197084519093675, 0.08903691430600141], [2457502.9269811464, 16.00281450771968, 0.07571005465623784], [2457643.7849324504, 17.572832199336744, 0.22249092533233417], [2457681.5054963874, 17.61153923746962, 0.24060264009148763], [2457681.68163965, 17.25286113780618, 0.2670445467777291], [2457681.7556396844, 17.555794794414748, 0.2003086988637216], [2457690.9356802045, 17.760103491304548, 0.3378350272795684], [2457691.009681709, 17.596587187251636, 0.2914181821317246], [2457691.185828424, 17.762201775906338, 0.250530086704737], [2457691.259831408, 17.704714934038503, 0.27122173362036267], [2457782.077570622, 17.7978819574828, 0.2733851202385386], [2457782.2537419554, 17.74040660332473, 0.26677605429884443], [2457782.327753696, 17.78750342251827, 0.24657792229536682], [2457793.8908537743, 17.592326382618012, 0.4843930725449877], [2457794.067027321, 17.82192554339962, 0.23223726974585968], [2457794.141041761, 17.831455174325885, 0.24708007223523026], [2457829.545573648, 17.74216026828207, 0.24717677436909988]],
            },
            {
            "survey": "Gaia",
            "band": "RP",
            "lc": [[2456910.468096635, 14.89890735350567, 0.0625007758134266], [2456944.0983232222, 14.88315079975548, 0.058394080261497144], [2456944.172322946, 14.890607440029145, 0.05986875288561744], [2457078.389406806, 14.888550076304455, 0.06313312087652372], [2457078.4634235767, 14.907205714276405, 0.06012664843504206], [2457107.878447696, 14.874788498007874, 0.05900024267269985], [2457107.952460759, 14.883704639733054, 0.06194419274065489], [2457267.9133636383, 14.853566947067122, 0.057003137019366185], [2457300.3923433195, 14.840071378227243, 0.05884674247087192], [2457318.4674796057, 14.8305878917394, 0.05806961062261091], [2457318.6436198885, 14.840092367840226, 0.06041400535904676], [2457453.938756272, 13.767286960214115, 0.0339206314130224], [2457488.67042345, 13.142662093961096, 0.028921513961562353], [2457488.744436219, 13.140468981512628, 0.02531252575954629], [2457502.6768835555, 13.272681827170546, 0.02950188859770214], [2457502.750897395, 13.277249490994347, 0.026787647300743626], [2457502.92706999, 13.257349737595575, 0.02619391285382488], [2457643.785021562, 14.642966238808913, 0.05180910904322991], [2457681.505582934, 14.772284412415619, 0.06073108244967478], [2457681.681727678, 14.758031995587892, 0.05620880768883758], [2457681.7557291538, 14.769950181428433, 0.05633071036738776], [2457690.9357682965, 14.791068802392127, 0.05746941573524371], [2457691.009769871, 14.784525502384202, 0.061908636585918206], [2457691.1859133975, 14.771696048037649, 0.05915887637770136], [2457691.259916391, 14.773537584123812, 0.06542320058636238], [2457782.077656281, 14.87860307562256, 0.06863374147211153], [2457782.2538294313, 14.883193790975547, 0.06155435304974999], [2457782.32784283, 14.891312684472547, 0.061293227349077634], [2457793.890943061, 14.868231574918378, 0.058722486998822675], [2457794.067112813, 14.877269647060714, 0.06071804297084375], [2457794.141126696, 14.866592483071713, 0.060939771380428914], [2457829.5456623915, 14.88600620110277, 0.0630235885539985]],
            },
            {
            "survey": "OGLE",
            "band": "I",
            "lc": [[2457179.80619, 16.775, 0.005], [2457180.79341, 16.771, 0.005], [2457181.79356, 16.758, 0.005], [2457182.7985, 16.776, 0.005], [2457183.78742, 16.763, 0.005], [2457184.80806, 16.761, 0.005], [2457185.8004, 16.755, 0.005], [2457187.58745, 16.785, 0.005], [2457188.60153, 16.768, 0.005], [2457189.64668, 16.765, 0.005], [2457190.663, 16.778, 0.005], [2457191.79829, 16.79, 0.006], [2457194.6214, 16.762, 0.005], [2457197.66807, 16.775, 0.005], [2457198.74442, 16.775, 0.005], [2457199.76091, 16.771, 0.005], [2457200.75703, 16.773, 0.005], [2457206.76874, 16.777, 0.005], [2457207.74246, 16.774, 0.005], [2457211.55311, 16.774, 0.005], [2457214.53425, 16.786, 0.005], [2457220.61578, 16.775, 0.005], [2457622.54823, 16.449, 0.004], [2457623.69378, 16.433, 0.004], [2457625.63116, 16.444, 0.005], [2457630.61297, 16.475, 0.004], [2457632.59055, 16.473, 0.005], [2457635.58743, 16.495, 0.005], [2457639.50979, 16.507, 0.005], [2457821.88086, 16.765, 0.006], [2457823.83429, 16.77, 0.005], [2457824.90263, 16.758, 0.005], [2457826.82492, 16.756, 0.006], [2457827.88628, 16.765, 0.005], [2457829.8396, 16.766, 0.005], [2457834.80917, 16.782, 0.005], [2457835.76159, 16.766, 0.006], [2457835.90178, 16.769, 0.005], [2457836.8609, 16.771, 0.005], [2457837.81068, 16.76, 0.005], [2457838.75927, 16.78, 0.006], [2457839.76809, 16.777, 0.005], [2457840.78625, 16.775, 0.005], [2457841.81233, 16.772, 0.006], [2457842.80599, 16.753, 0.005], [2457843.80406, 16.768, 0.005], [2457844.81234, 16.771, 0.006], [2457845.80548, 16.769, 0.005], [2457846.80023, 16.767, 0.005], [2457847.77696, 16.785, 0.005], [2457848.76256, 16.755, 0.006], [2457849.75692, 16.762, 0.005], [2457850.73796, 16.784, 0.006], [2457850.92298, 16.768, 0.006], [2457851.9077, 16.764, 0.005], [2457854.75737, 16.756, 0.005], [2457855.74351, 16.763, 0.005], [2457856.7163, 16.782, 0.006], [2457856.9072, 16.783, 0.006], [2457869.68189, 16.777, 0.005], [2457870.73284, 16.763, 0.005], [2457871.77874, 16.77, 0.005], [2457872.849, 16.786, 0.005], [2457873.87548, 16.773, 0.005], [2457874.87893, 16.769, 0.005], [2457876.86671, 16.77, 0.005], [2457877.8684, 16.777, 0.005], [2457879.66876, 16.772, 0.006], [2457880.7345, 16.776, 0.005], [2457881.86243, 16.76, 0.005], [2457882.90042, 16.778, 0.005], [2457893.66752, 16.768, 0.005], [2457893.93431, 16.808, 0.006], [2457894.85835, 16.771, 0.005], [2457901.62822, 16.781, 0.005], [2457902.67771, 16.771, 0.005], [2457903.81869, 16.77, 0.005], [2457904.7467, 16.776, 0.005], [2457905.65886, 16.781, 0.005], [2457906.59218, 16.771, 0.005], [2457906.86512, 16.776, 0.005], [2457908.74088, 16.768, 0.005], [2457909.64991, 16.766, 0.005], [2457910.7234, 16.78, 0.005], [2457916.64521, 16.758, 0.005], [2457916.8783, 16.768, 0.006], [2457917.77539, 16.774, 0.005], [2457922.57071, 16.743, 0.007], [2457923.62424, 16.781, 0.005], [2457924.54629, 16.768, 0.005], [2457924.81182, 16.782, 0.005], [2457925.78429, 16.782, 0.006], [2457926.75136, 16.77, 0.005], [2457933.56403, 16.792, 0.007], [2457934.55593, 16.774, 0.005], [2457934.81776, 16.774, 0.005], [2458189.79912, 16.766, 0.005], [2458190.9021, 16.773, 0.005], [2458192.89675, 16.793, 0.005]],
            },
        ],
        "fit_result" : {'PSPL_no_blend_no_piE':
                            {'t0': np.float64(2457500.69467), 't0_error': np.float64(3.71982), 'u0': np.float64(0.21646), 'u0_error': np.float64(0.00438), 'tE': np.float64(133.5235), 'tE_error': np.float64(4.20289), 'fsource_Gaia_G': np.float64(31219.60764), 'fsource_Gaia_G_error': np.float64(273.60805), 'fsource_Gaia_BP': np.float64(7024.54695), 'fsource_Gaia_BP_error': np.float64(413.82865), 'fsource_Gaia_RP': np.float64(97750.27662), 'fsource_Gaia_RP_error': np.float64(1578.53759), 'fsource_OGLE_I': np.float64(17418.16827), 'fsource_OGLE_I_error': np.float64(41.2875), 'chi2': np.float64(1361.249), 'red_chi2': np.float64(7.202), 'source_magnitude': np.float64(16.164), 'blend_magnitude': "nan", 'source_mag_error': np.float64(123.886), 'blend_mag_error': "nan", 'baseline_magnitude': np.float64(16.164), 'baseline_mag_error': np.float64(123.886), 'fit_covariance': [[13.837066909574936, 0.009722052717544529, -14.856772935614705, 337.70666108448376, 292.2883299213551, 1218.0115641732996, 109.5078734830099], [0.009722052717541958, 1.9214604383504807e-05, -0.010619436827432497, 0.6266543511550942, 0.32213291404395417, 2.3022791735804735, 0.08219017793162842], [-14.856772935614778, -0.010619436827435158, 17.664254587262516, -433.9751232423351, -331.25365356895696, -1518.5785208996767, -142.64781969809508], [337.7066610844507, 0.6266543511551321, -433.97512324230036, 74861.36546967053, 11408.967739116031, 82494.88290790505, 3797.8488227876087], [292.2883299213432, 0.322132914044022, -331.25365356894247, 11408.967739116599, 171254.14806075054, 41111.54486559283, 2592.4470011644107], [1218.0115641732011, 2.3022791735805788, -1518.5785208995655, 82494.882907906, 41111.54486559082, 2491780.9302091845, 13024.836384195494], [109.50787348301088, 0.08219017793164177, -142.6478196980955, 3797.8488227878, 2592.447001164532, 13024.836384196338, 1704.6578574862658]], 'fit_parameters': OrderedDict([('t0', [0, [np.float64(2456910.4676960483), np.float64(2458202.89675)]]), ('u0', [1, [0.0, 2.0]]), ('tE', [2, [1.0, 3000.0]]), ('fsource_Gaia_G', [3, (0.0, np.float64(33755.75602572047))]), ('fsource_Gaia_BP', [4, (0.0, np.float64(7337.170544004541))]), ('fsource_Gaia_RP', [5, (0.0, np.float64(105673.7819930607))]), ('fsource_OGLE_I', [6, (0.0, np.float64(17848.42916498003))])]), 'sw_test': np.float64(0.615), 'ad_test': np.float64(4.858), 'ks_test': np.float64(0.145), 'aic_test': np.float64(1375.249), 'bic_test': np.float64(1398.196)},
                        'PSPL_blend_no_piE':
                            {'t0': np.float64(2457492.17681), 't0_error': np.float64(1.32867), 'u0': np.float64(0.15261), 'u0_error': np.float64(0.04816), 'tE': np.float64(138.64862), 'tE_error': np.float64(21.32816), 'fsource_Gaia_G': np.float64(23331.22067), 'fsource_Gaia_G_error': np.float64(8199.50605), 'ftotal_Gaia_G': np.float64(31791.39128), 'ftotal_Gaia_G_error': np.float64(373.24428), 'fsource_Gaia_BP': np.float64(5117.29399), 'fsource_Gaia_BP_error': np.float64(1805.54698), 'ftotal_Gaia_BP': np.float64(6897.46442), 'ftotal_Gaia_BP_error': np.float64(547.7498), 'fsource_Gaia_RP': np.float64(72456.74238), 'fsource_Gaia_RP_error': np.float64(25436.75691), 'ftotal_Gaia_RP': np.float64(99290.21224), 'ftotal_Gaia_RP_error': np.float64(2113.11798), 'fsource_OGLE_I': np.float64(17848.42916), 'fsource_OGLE_I_error': np.float64(5911.043), 'ftotal_OGLE_I': np.float64(17377.20438), 'ftotal_OGLE_I_error': np.float64(80.52799), 'chi2': np.float64(1184.93), 'red_chi2': np.float64(6.405), 'source_magnitude': np.float64(16.48), 'blend_magnitude': "nan", 'source_mag_error': np.float64(3.089), 'blend_mag_error': "nan", 'baseline_magnitude': np.float64(16.144), 'baseline_mag_error': np.float64(92.478), 'fit_covariance': [[1.76536886880205, -0.044460109503600145, 14.900575865455789, -7713.151856566214, 34.253080082105164, -1606.4451573243678, 34.28641818517994, -23748.93431518773, 162.8969368334325, -4538.926683304012, -46.461362819954374], [-0.04446010950364674, 0.0023195968106398098, -0.9339803645001092, 394.24203978288523, 2.8255976062328494, 84.25989983280296, -0.4110492212468885, 1221.293142425761, 6.6589029712875965, 263.80120134091084, 3.1950981302333927], [14.900575865479157, -0.933980364500315, 454.8903041228619, -159901.2646712328, -3452.9986206506956, -34323.013695970076, -483.3760363617619, -495093.2372197885, -10368.38072719407, -125492.29881375219, -1601.830327229769], [-7713.1518565740735, 394.2420397828795, -159901.26467119527, 67231899.44989222, 490361.3040422343, 14328398.028491728, -60736.39073758762, 207739476.42357004, 1245482.404414518, 45174214.7832099, 546989.1227473597], [34.25308008191695, 2.8255976062389307, -3452.9986206529134, 490361.30404328275, 139311.29568244403, 114268.55535553535, 18559.051869691983, 1585728.1087641467, 233901.1553487665, 887379.2131834916, 13154.990607851829], [-1606.4451573260712, 84.25989983280347, -34323.013695962814, 14328398.028492022, 114268.55535531513, 3259999.8954227515, -87879.42404492166, 44384351.38322999, 280518.22687441396, 9681215.021673985, 117624.11690396778], [34.2864181851485, -0.41104922124520415, -483.37603636246996, -60736.390737299334, 18559.051869694737, -87879.42404486032, 300029.8475588133, -189903.97592649062, 62095.82768373281, 111448.32449185115, 2035.5018491517353], [-23748.934315212224, 1221.2931424257504, -495093.23721967515, 207739476.42357126, 1585728.108760909, 44384351.38322934, -189903.9759273846, 647028602.2666026, 2860245.769691192, 139838075.62333, 1694001.9085788708], [162.89693683291128, 6.658902971306344, -10368.380727201175, 1245482.4044177465, 233901.15534877405, 280518.22687509394, 62095.82768372691, 2860245.769701171, 4465267.583900603, 2637454.9639419727, 39916.464801935195], [-4538.9266833102665, 263.80120134095176, -125492.29881374509, 45174214.783217564, 887379.2131828406, 9681215.021675413, 111448.32449165198, 139838075.62335292, 2637454.963939913, 34940429.34115419, 433651.26469768974], [-46.46136282003888, 3.1950981302343227, -1601.830327229863, 546989.1227475267, 13154.99060784458, 117624.11690400081, 2035.5018491493008, 1694001.9085793786, 39916.46480191164, 433651.26469774044, 6484.75706571364]], 'fit_parameters': OrderedDict([('t0', [0, [np.float64(2456910.4676960483), np.float64(2458202.89675)]]), ('u0', [1, [0.0, 2.0]]), ('tE', [2, [1.0, 3000.0]]), ('fsource_Gaia_G', [3, (0.0, np.float64(33755.75602572047))]), ('ftotal_Gaia_G', [4, (0, np.float64(33755.75602572047))]), ('fsource_Gaia_BP', [5, (0.0, np.float64(7337.170544004541))]), ('ftotal_Gaia_BP', [6, (0, np.float64(7337.170544004541))]), ('fsource_Gaia_RP', [7, (0.0, np.float64(105673.7819930607))]), ('ftotal_Gaia_RP', [8, (0, np.float64(105673.7819930607))]), ('fsource_OGLE_I', [9, (0.0, np.float64(17848.42916498003))]), ('ftotal_OGLE_I', [10, (0, np.float64(17848.42916498003))])]), 'sw_test': np.float64(0.873), 'ad_test': np.float64(1.668), 'ks_test': np.float64(0.145), 'aic_test': np.float64(1206.93), 'bic_test': np.float64(1242.989)},
                        'PSPL_blend_piE_---':
                            {'t0': np.float64(2457486.13333), 't0_error': np.float64(1.42619), 'u0': np.float64(0.11776), 'u0_error': np.float64(0.01478), 'tE': np.float64(169.58239), 'tE_error': np.float64(16.3665), 'piEN': np.float64(0.55407), 'piEN_error': np.float64(0.11561), 'piEE': np.float64(0.35381), 'piEE_error': np.float64(0.10583), 'fsource_Gaia_G': np.float64(18273.3667), 'fsource_Gaia_G_error': np.float64(2479.27615), 'ftotal_Gaia_G': np.float64(32482.38444), 'ftotal_Gaia_G_error': np.float64(210.46696), 'fsource_Gaia_BP': np.float64(3963.14049), 'fsource_Gaia_BP_error': np.float64(578.76735), 'ftotal_Gaia_BP': np.float64(7065.21445), 'ftotal_Gaia_BP_error': np.float64(353.82455), 'fsource_Gaia_RP': np.float64(56612.73528), 'fsource_Gaia_RP_error': np.float64(7710.61049), 'ftotal_Gaia_RP': np.float64(101807.16988), 'ftotal_Gaia_RP_error': np.float64(1269.08367), 'fsource_OGLE_I': np.float64(10982.4347), 'fsource_OGLE_I_error': np.float64(1595.8841), 'ftotal_OGLE_I': np.float64(17747.59771), 'ftotal_OGLE_I_error': np.float64(40.56458), 'chi2': np.float64(326.497), 'red_chi2': np.float64(1.784), 'source_magnitude': np.float64(16.745), 'blend_magnitude': "nan", 'source_mag_error': np.float64(8.002), 'blend_mag_error': "nan", 'baseline_magnitude': np.float64(16.121), 'baseline_mag_error': np.float64(167.567), 'fit_covariance': [[2.0340163669556865, 0.0010530684231082426, -1.7822259637062305, -0.1403283642660809, -0.13467154431242653, -335.61093031746657, -107.09853962627894, -73.56701514157751, -25.099774719975333, -1065.6474276628078, -366.06009464957947, 64.82876687415039, -47.45723063221587], [0.001053068423344903, 0.00021847083431835942, -0.23588261242823946, 3.080357534744376e-05, 0.0005353981408275422, 36.164995957979784, 1.0623986036102426, 7.848502637561465, 0.1713705831550436, 111.94698274518288, 3.027524079343299, 17.89179032963147, 0.2114952237104577], [-1.7822259639726765, -0.2358826124281626, 267.8622555482823, -0.07314572996048001, -0.5162875367079464, -39270.536809422236, -1383.6943319078314, -8516.986627338863, -230.15449181446067, -121563.76343200971, -3977.7133979999526, -22165.87324231181, -209.15096673683573], [-0.14032836426590675, 3.080357536430999e-05, -0.07314572997953436, 0.013365252991088539, 0.009945107359230673, 41.59339308433285, 12.696229382165503, 9.023388141388262, 2.771373489047018, 128.15827384618154, 41.905335975053475, 54.73791810283018, 3.6063018772165263], [-0.1346715443117893, 0.0005353981408437422, -0.5162875367263992, 0.009945107359197184, 0.011200506504320995, 122.87187681708356, 10.3918406247546, 26.68916618462374, 2.2608101604340605, 380.7953977182518, 34.132344502064505, 39.17973252798548, 4.012494899256309], [-335.61093027768413, 36.16499595803898, -39270.5368095018, 41.59339308154068, 122.87187681451965, 6146810.241410887, 205558.99430780855, 1329751.4367583988, 36275.65335308745, 18974031.881821096, 617906.7851871214, 3031074.486692605, 47145.08484401642], [-107.0985396248385, 1.0623986036238753, -1383.694331923654, 12.696229382072875, 10.3918406246927, 205558.9943097398, 44296.343205208876, 45690.44020697477, 3989.754316893301, 652141.9334149592, 62776.87139860181, 177877.07294151542, 3904.500200354805], [-73.5670151329571, 7.8485026375743665, -8516.98662735619, 9.023388140783275, 26.68916618406838, 1329751.4367584113, 45690.44020655673, 334971.64421906695, -15274.85350831724, 4117831.1855873265, 133801.69708825406, 656881.5036328445, 10238.573199523633], [-25.099774719723694, 0.1713705831582029, -230.15449181810473, 2.771373489031417, 2.2608101604253563, 36275.653353556125, 3989.754316898086, -15274.853508215814, 125191.80877345655, 112061.60619089309, 12635.514065740543, 31396.204789551943, 840.4319313209083], [-1065.647427539647, 111.94698274536941, -121563.76343225972, 128.15827383754015, 380.79539771032324, 18974031.881821644, 652141.9334090002, 4117831.1855874057, 112061.6061894457, 59453514.10931485, 1631356.1682316088, 9372724.30169499, 146048.7838614667], [-366.06009464538636, 3.0275240793892855, -3977.7133980531603, 41.905335974788535, 34.132344501901244, 617906.785193811, 62776.87139864043, 133801.69708970253, 12635.514065733421, 1631356.1682522604, 1610573.3544198596, 527276.7881083281, 12757.513742712326], [64.82876689595486, 17.89179032963741, -22165.873242325608, 54.73791810127941, 39.179732526507934, 3031074.4866881547, 177877.0729402956, 656881.5036318733, 31396.20478926668, 9372724.30168091, 527276.7881041922, 2546846.0463484656, 16580.75626793833], [-47.457230631964514, 0.21149522371619495, -209.15096674337613, 3.6063018772028927, 4.012494899254592, 47145.084844917896, 3904.5002003752275, 10238.573199718896, 840.4319313236415, 146048.78386425407, 12757.51374276502, 16580.756268460755, 1645.4853514045776]], 'fit_parameters': OrderedDict([('t0', [0, [np.float64(2456910.4676960483), np.float64(2458202.89675)]]), ('u0', [1, [0.0, 2.0]]), ('tE', [2, [1.0, 3000.0]]), ('piEN', [3, [-2.0, 2.0]]), ('piEE', [4, [-2.0, 2.0]]), ('fsource_Gaia_G', [5, (0.0, np.float64(33755.75602572047))]), ('ftotal_Gaia_G', [6, (0, np.float64(33755.75602572047))]), ('fsource_Gaia_BP', [7, (0.0, np.float64(7337.170544004541))]), ('ftotal_Gaia_BP', [8, (0, np.float64(7337.170544004541))]), ('fsource_Gaia_RP', [9, (0.0, np.float64(105673.7819930607))]), ('ftotal_Gaia_RP', [10, (0, np.float64(105673.7819930607))]), ('fsource_OGLE_I', [11, (0.0, np.float64(17848.42916498003))]), ('ftotal_OGLE_I', [12, (0, np.float64(17848.42916498003))])]), 'sw_test': np.float64(0.875), 'ad_test': np.float64(1.714), 'ks_test': np.float64(0.271), 'aic_test': np.float64(352.497), 'bic_test': np.float64(395.112)},
                        'PSPL_blend_piE_--+':
                            {'t0': np.float64(2457486.13333), 't0_error': np.float64(1.42619), 'u0': np.float64(0.11776), 'u0_error': np.float64(0.01478), 'tE': np.float64(169.58239), 'tE_error': np.float64(16.3665), 'piEN': np.float64(0.55407), 'piEN_error': np.float64(0.11561), 'piEE': np.float64(0.35381), 'piEE_error': np.float64(0.10583), 'fsource_Gaia_G': np.float64(18273.3667), 'fsource_Gaia_G_error': np.float64(2479.27615), 'ftotal_Gaia_G': np.float64(32482.38444), 'ftotal_Gaia_G_error': np.float64(210.46696), 'fsource_Gaia_BP': np.float64(3963.14049), 'fsource_Gaia_BP_error': np.float64(578.76735), 'ftotal_Gaia_BP': np.float64(7065.21445), 'ftotal_Gaia_BP_error': np.float64(353.82455), 'fsource_Gaia_RP': np.float64(56612.73528), 'fsource_Gaia_RP_error': np.float64(7710.61049), 'ftotal_Gaia_RP': np.float64(101807.16988), 'ftotal_Gaia_RP_error': np.float64(1269.08367), 'fsource_OGLE_I': np.float64(10982.4347), 'fsource_OGLE_I_error': np.float64(1595.8841), 'ftotal_OGLE_I': np.float64(17747.59771), 'ftotal_OGLE_I_error': np.float64(40.56458), 'chi2': np.float64(326.497), 'red_chi2': np.float64(1.784), 'source_magnitude': np.float64(16.745), 'blend_magnitude': "nan", 'source_mag_error': np.float64(8.002), 'blend_mag_error': "nan", 'baseline_magnitude': np.float64(16.121), 'baseline_mag_error': np.float64(167.567), 'fit_covariance': [[2.0340163669556865, 0.0010530684231082426, -1.7822259637062305, -0.1403283642660809, -0.13467154431242653, -335.61093031746657, -107.09853962627894, -73.56701514157751, -25.099774719975333, -1065.6474276628078, -366.06009464957947, 64.82876687415039, -47.45723063221587], [0.001053068423344903, 0.00021847083431835942, -0.23588261242823946, 3.080357534744376e-05, 0.0005353981408275422, 36.164995957979784, 1.0623986036102426, 7.848502637561465, 0.1713705831550436, 111.94698274518288, 3.027524079343299, 17.89179032963147, 0.2114952237104577], [-1.7822259639726765, -0.2358826124281626, 267.8622555482823, -0.07314572996048001, -0.5162875367079464, -39270.536809422236, -1383.6943319078314, -8516.986627338863, -230.15449181446067, -121563.76343200971, -3977.7133979999526, -22165.87324231181, -209.15096673683573], [-0.14032836426590675, 3.080357536430999e-05, -0.07314572997953436, 0.013365252991088539, 0.009945107359230673, 41.59339308433285, 12.696229382165503, 9.023388141388262, 2.771373489047018, 128.15827384618154, 41.905335975053475, 54.73791810283018, 3.6063018772165263], [-0.1346715443117893, 0.0005353981408437422, -0.5162875367263992, 0.009945107359197184, 0.011200506504320995, 122.87187681708356, 10.3918406247546, 26.68916618462374, 2.2608101604340605, 380.7953977182518, 34.132344502064505, 39.17973252798548, 4.012494899256309], [-335.61093027768413, 36.16499595803898, -39270.5368095018, 41.59339308154068, 122.87187681451965, 6146810.241410887, 205558.99430780855, 1329751.4367583988, 36275.65335308745, 18974031.881821096, 617906.7851871214, 3031074.486692605, 47145.08484401642], [-107.0985396248385, 1.0623986036238753, -1383.694331923654, 12.696229382072875, 10.3918406246927, 205558.9943097398, 44296.343205208876, 45690.44020697477, 3989.754316893301, 652141.9334149592, 62776.87139860181, 177877.07294151542, 3904.500200354805], [-73.5670151329571, 7.8485026375743665, -8516.98662735619, 9.023388140783275, 26.68916618406838, 1329751.4367584113, 45690.44020655673, 334971.64421906695, -15274.85350831724, 4117831.1855873265, 133801.69708825406, 656881.5036328445, 10238.573199523633], [-25.099774719723694, 0.1713705831582029, -230.15449181810473, 2.771373489031417, 2.2608101604253563, 36275.653353556125, 3989.754316898086, -15274.853508215814, 125191.80877345655, 112061.60619089309, 12635.514065740543, 31396.204789551943, 840.4319313209083], [-1065.647427539647, 111.94698274536941, -121563.76343225972, 128.15827383754015, 380.79539771032324, 18974031.881821644, 652141.9334090002, 4117831.1855874057, 112061.6061894457, 59453514.10931485, 1631356.1682316088, 9372724.30169499, 146048.7838614667], [-366.06009464538636, 3.0275240793892855, -3977.7133980531603, 41.905335974788535, 34.132344501901244, 617906.785193811, 62776.87139864043, 133801.69708970253, 12635.514065733421, 1631356.1682522604, 1610573.3544198596, 527276.7881083281, 12757.513742712326], [64.82876689595486, 17.89179032963741, -22165.873242325608, 54.73791810127941, 39.179732526507934, 3031074.4866881547, 177877.0729402956, 656881.5036318733, 31396.20478926668, 9372724.30168091, 527276.7881041922, 2546846.0463484656, 16580.75626793833], [-47.457230631964514, 0.21149522371619495, -209.15096674337613, 3.6063018772028927, 4.012494899254592, 47145.084844917896, 3904.5002003752275, 10238.573199718896, 840.4319313236415, 146048.78386425407, 12757.51374276502, 16580.756268460755, 1645.4853514045776]], 'fit_parameters': OrderedDict([('t0', [0, [np.float64(2456910.4676960483), np.float64(2458202.89675)]]), ('u0', [1, [0.0, 2.0]]), ('tE', [2, [1.0, 3000.0]]), ('piEN', [3, [-2.0, 2.0]]), ('piEE', [4, [-2.0, 2.0]]), ('fsource_Gaia_G', [5, (0.0, np.float64(33755.75602572047))]), ('ftotal_Gaia_G', [6, (0, np.float64(33755.75602572047))]), ('fsource_Gaia_BP', [7, (0.0, np.float64(7337.170544004541))]), ('ftotal_Gaia_BP', [8, (0, np.float64(7337.170544004541))]), ('fsource_Gaia_RP', [9, (0.0, np.float64(105673.7819930607))]), ('ftotal_Gaia_RP', [10, (0, np.float64(105673.7819930607))]), ('fsource_OGLE_I', [11, (0.0, np.float64(17848.42916498003))]), ('ftotal_OGLE_I', [12, (0, np.float64(17848.42916498003))])]), 'sw_test': np.float64(0.875), 'ad_test': np.float64(1.714), 'ks_test': np.float64(0.271), 'aic_test': np.float64(352.497), 'bic_test': np.float64(395.112)},
                        'PSPL_blend_piE_-+-':
                            {'t0': np.float64(2457486.13333), 't0_error': np.float64(1.42619), 'u0': np.float64(0.11776), 'u0_error': np.float64(0.01478), 'tE': np.float64(169.58239), 'tE_error': np.float64(16.3665), 'piEN': np.float64(0.55407), 'piEN_error': np.float64(0.11561), 'piEE': np.float64(0.35381), 'piEE_error': np.float64(0.10583), 'fsource_Gaia_G': np.float64(18273.3667), 'fsource_Gaia_G_error': np.float64(2479.27615), 'ftotal_Gaia_G': np.float64(32482.38444), 'ftotal_Gaia_G_error': np.float64(210.46696), 'fsource_Gaia_BP': np.float64(3963.14049), 'fsource_Gaia_BP_error': np.float64(578.76735), 'ftotal_Gaia_BP': np.float64(7065.21445), 'ftotal_Gaia_BP_error': np.float64(353.82455), 'fsource_Gaia_RP': np.float64(56612.73528), 'fsource_Gaia_RP_error': np.float64(7710.61049), 'ftotal_Gaia_RP': np.float64(101807.16988), 'ftotal_Gaia_RP_error': np.float64(1269.08367), 'fsource_OGLE_I': np.float64(10982.4347), 'fsource_OGLE_I_error': np.float64(1595.8841), 'ftotal_OGLE_I': np.float64(17747.59771), 'ftotal_OGLE_I_error': np.float64(40.56458), 'chi2': np.float64(326.497), 'red_chi2': np.float64(1.784), 'source_magnitude': np.float64(16.745), 'blend_magnitude': "nan", 'source_mag_error': np.float64(8.002), 'blend_mag_error': "nan", 'baseline_magnitude': np.float64(16.121), 'baseline_mag_error': np.float64(167.567), 'fit_covariance': [[2.0340163669556865, 0.0010530684231082426, -1.7822259637062305, -0.1403283642660809, -0.13467154431242653, -335.61093031746657, -107.09853962627894, -73.56701514157751, -25.099774719975333, -1065.6474276628078, -366.06009464957947, 64.82876687415039, -47.45723063221587], [0.001053068423344903, 0.00021847083431835942, -0.23588261242823946, 3.080357534744376e-05, 0.0005353981408275422, 36.164995957979784, 1.0623986036102426, 7.848502637561465, 0.1713705831550436, 111.94698274518288, 3.027524079343299, 17.89179032963147, 0.2114952237104577], [-1.7822259639726765, -0.2358826124281626, 267.8622555482823, -0.07314572996048001, -0.5162875367079464, -39270.536809422236, -1383.6943319078314, -8516.986627338863, -230.15449181446067, -121563.76343200971, -3977.7133979999526, -22165.87324231181, -209.15096673683573], [-0.14032836426590675, 3.080357536430999e-05, -0.07314572997953436, 0.013365252991088539, 0.009945107359230673, 41.59339308433285, 12.696229382165503, 9.023388141388262, 2.771373489047018, 128.15827384618154, 41.905335975053475, 54.73791810283018, 3.6063018772165263], [-0.1346715443117893, 0.0005353981408437422, -0.5162875367263992, 0.009945107359197184, 0.011200506504320995, 122.87187681708356, 10.3918406247546, 26.68916618462374, 2.2608101604340605, 380.7953977182518, 34.132344502064505, 39.17973252798548, 4.012494899256309], [-335.61093027768413, 36.16499595803898, -39270.5368095018, 41.59339308154068, 122.87187681451965, 6146810.241410887, 205558.99430780855, 1329751.4367583988, 36275.65335308745, 18974031.881821096, 617906.7851871214, 3031074.486692605, 47145.08484401642], [-107.0985396248385, 1.0623986036238753, -1383.694331923654, 12.696229382072875, 10.3918406246927, 205558.9943097398, 44296.343205208876, 45690.44020697477, 3989.754316893301, 652141.9334149592, 62776.87139860181, 177877.07294151542, 3904.500200354805], [-73.5670151329571, 7.8485026375743665, -8516.98662735619, 9.023388140783275, 26.68916618406838, 1329751.4367584113, 45690.44020655673, 334971.64421906695, -15274.85350831724, 4117831.1855873265, 133801.69708825406, 656881.5036328445, 10238.573199523633], [-25.099774719723694, 0.1713705831582029, -230.15449181810473, 2.771373489031417, 2.2608101604253563, 36275.653353556125, 3989.754316898086, -15274.853508215814, 125191.80877345655, 112061.60619089309, 12635.514065740543, 31396.204789551943, 840.4319313209083], [-1065.647427539647, 111.94698274536941, -121563.76343225972, 128.15827383754015, 380.79539771032324, 18974031.881821644, 652141.9334090002, 4117831.1855874057, 112061.6061894457, 59453514.10931485, 1631356.1682316088, 9372724.30169499, 146048.7838614667], [-366.06009464538636, 3.0275240793892855, -3977.7133980531603, 41.905335974788535, 34.132344501901244, 617906.785193811, 62776.87139864043, 133801.69708970253, 12635.514065733421, 1631356.1682522604, 1610573.3544198596, 527276.7881083281, 12757.513742712326], [64.82876689595486, 17.89179032963741, -22165.873242325608, 54.73791810127941, 39.179732526507934, 3031074.4866881547, 177877.0729402956, 656881.5036318733, 31396.20478926668, 9372724.30168091, 527276.7881041922, 2546846.0463484656, 16580.75626793833], [-47.457230631964514, 0.21149522371619495, -209.15096674337613, 3.6063018772028927, 4.012494899254592, 47145.084844917896, 3904.5002003752275, 10238.573199718896, 840.4319313236415, 146048.78386425407, 12757.51374276502, 16580.756268460755, 1645.4853514045776]], 'fit_parameters': OrderedDict([('t0', [0, [np.float64(2456910.4676960483), np.float64(2458202.89675)]]), ('u0', [1, [0.0, 2.0]]), ('tE', [2, [1.0, 3000.0]]), ('piEN', [3, [-2.0, 2.0]]), ('piEE', [4, [-2.0, 2.0]]), ('fsource_Gaia_G', [5, (0.0, np.float64(33755.75602572047))]), ('ftotal_Gaia_G', [6, (0, np.float64(33755.75602572047))]), ('fsource_Gaia_BP', [7, (0.0, np.float64(7337.170544004541))]), ('ftotal_Gaia_BP', [8, (0, np.float64(7337.170544004541))]), ('fsource_Gaia_RP', [9, (0.0, np.float64(105673.7819930607))]), ('ftotal_Gaia_RP', [10, (0, np.float64(105673.7819930607))]), ('fsource_OGLE_I', [11, (0.0, np.float64(17848.42916498003))]), ('ftotal_OGLE_I', [12, (0, np.float64(17848.42916498003))])]), 'sw_test': np.float64(0.875), 'ad_test': np.float64(1.714), 'ks_test': np.float64(0.271), 'aic_test': np.float64(352.497), 'bic_test': np.float64(395.112)},
                        'PSPL_blend_piE_-++':
                            {'t0': np.float64(2457486.13333), 't0_error': np.float64(1.42619), 'u0': np.float64(0.11776), 'u0_error': np.float64(0.01478), 'tE': np.float64(169.58239), 'tE_error': np.float64(16.3665), 'piEN': np.float64(0.55407), 'piEN_error': np.float64(0.11561), 'piEE': np.float64(0.35381), 'piEE_error': np.float64(0.10583), 'fsource_Gaia_G': np.float64(18273.3667), 'fsource_Gaia_G_error': np.float64(2479.27615), 'ftotal_Gaia_G': np.float64(32482.38444), 'ftotal_Gaia_G_error': np.float64(210.46696), 'fsource_Gaia_BP': np.float64(3963.14049), 'fsource_Gaia_BP_error': np.float64(578.76735), 'ftotal_Gaia_BP': np.float64(7065.21445), 'ftotal_Gaia_BP_error': np.float64(353.82455), 'fsource_Gaia_RP': np.float64(56612.73528), 'fsource_Gaia_RP_error': np.float64(7710.61049), 'ftotal_Gaia_RP': np.float64(101807.16988), 'ftotal_Gaia_RP_error': np.float64(1269.08367), 'fsource_OGLE_I': np.float64(10982.4347), 'fsource_OGLE_I_error': np.float64(1595.8841), 'ftotal_OGLE_I': np.float64(17747.59771), 'ftotal_OGLE_I_error': np.float64(40.56458), 'chi2': np.float64(326.497), 'red_chi2': np.float64(1.784), 'source_magnitude': np.float64(16.745), 'blend_magnitude': "nan", 'source_mag_error': np.float64(8.002), 'blend_mag_error': "nan", 'baseline_magnitude': np.float64(16.121), 'baseline_mag_error': np.float64(167.567), 'fit_covariance': [[2.0340163669556865, 0.0010530684231082426, -1.7822259637062305, -0.1403283642660809, -0.13467154431242653, -335.61093031746657, -107.09853962627894, -73.56701514157751, -25.099774719975333, -1065.6474276628078, -366.06009464957947, 64.82876687415039, -47.45723063221587], [0.001053068423344903, 0.00021847083431835942, -0.23588261242823946, 3.080357534744376e-05, 0.0005353981408275422, 36.164995957979784, 1.0623986036102426, 7.848502637561465, 0.1713705831550436, 111.94698274518288, 3.027524079343299, 17.89179032963147, 0.2114952237104577], [-1.7822259639726765, -0.2358826124281626, 267.8622555482823, -0.07314572996048001, -0.5162875367079464, -39270.536809422236, -1383.6943319078314, -8516.986627338863, -230.15449181446067, -121563.76343200971, -3977.7133979999526, -22165.87324231181, -209.15096673683573], [-0.14032836426590675, 3.080357536430999e-05, -0.07314572997953436, 0.013365252991088539, 0.009945107359230673, 41.59339308433285, 12.696229382165503, 9.023388141388262, 2.771373489047018, 128.15827384618154, 41.905335975053475, 54.73791810283018, 3.6063018772165263], [-0.1346715443117893, 0.0005353981408437422, -0.5162875367263992, 0.009945107359197184, 0.011200506504320995, 122.87187681708356, 10.3918406247546, 26.68916618462374, 2.2608101604340605, 380.7953977182518, 34.132344502064505, 39.17973252798548, 4.012494899256309], [-335.61093027768413, 36.16499595803898, -39270.5368095018, 41.59339308154068, 122.87187681451965, 6146810.241410887, 205558.99430780855, 1329751.4367583988, 36275.65335308745, 18974031.881821096, 617906.7851871214, 3031074.486692605, 47145.08484401642], [-107.0985396248385, 1.0623986036238753, -1383.694331923654, 12.696229382072875, 10.3918406246927, 205558.9943097398, 44296.343205208876, 45690.44020697477, 3989.754316893301, 652141.9334149592, 62776.87139860181, 177877.07294151542, 3904.500200354805], [-73.5670151329571, 7.8485026375743665, -8516.98662735619, 9.023388140783275, 26.68916618406838, 1329751.4367584113, 45690.44020655673, 334971.64421906695, -15274.85350831724, 4117831.1855873265, 133801.69708825406, 656881.5036328445, 10238.573199523633], [-25.099774719723694, 0.1713705831582029, -230.15449181810473, 2.771373489031417, 2.2608101604253563, 36275.653353556125, 3989.754316898086, -15274.853508215814, 125191.80877345655, 112061.60619089309, 12635.514065740543, 31396.204789551943, 840.4319313209083], [-1065.647427539647, 111.94698274536941, -121563.76343225972, 128.15827383754015, 380.79539771032324, 18974031.881821644, 652141.9334090002, 4117831.1855874057, 112061.6061894457, 59453514.10931485, 1631356.1682316088, 9372724.30169499, 146048.7838614667], [-366.06009464538636, 3.0275240793892855, -3977.7133980531603, 41.905335974788535, 34.132344501901244, 617906.785193811, 62776.87139864043, 133801.69708970253, 12635.514065733421, 1631356.1682522604, 1610573.3544198596, 527276.7881083281, 12757.513742712326], [64.82876689595486, 17.89179032963741, -22165.873242325608, 54.73791810127941, 39.179732526507934, 3031074.4866881547, 177877.0729402956, 656881.5036318733, 31396.20478926668, 9372724.30168091, 527276.7881041922, 2546846.0463484656, 16580.75626793833], [-47.457230631964514, 0.21149522371619495, -209.15096674337613, 3.6063018772028927, 4.012494899254592, 47145.084844917896, 3904.5002003752275, 10238.573199718896, 840.4319313236415, 146048.78386425407, 12757.51374276502, 16580.756268460755, 1645.4853514045776]], 'fit_parameters': OrderedDict([('t0', [0, [np.float64(2456910.4676960483), np.float64(2458202.89675)]]), ('u0', [1, [0.0, 2.0]]), ('tE', [2, [1.0, 3000.0]]), ('piEN', [3, [-2.0, 2.0]]), ('piEE', [4, [-2.0, 2.0]]), ('fsource_Gaia_G', [5, (0.0, np.float64(33755.75602572047))]), ('ftotal_Gaia_G', [6, (0, np.float64(33755.75602572047))]), ('fsource_Gaia_BP', [7, (0.0, np.float64(7337.170544004541))]), ('ftotal_Gaia_BP', [8, (0, np.float64(7337.170544004541))]), ('fsource_Gaia_RP', [9, (0.0, np.float64(105673.7819930607))]), ('ftotal_Gaia_RP', [10, (0, np.float64(105673.7819930607))]), ('fsource_OGLE_I', [11, (0.0, np.float64(17848.42916498003))]), ('ftotal_OGLE_I', [12, (0, np.float64(17848.42916498003))])]), 'sw_test': np.float64(0.875), 'ad_test': np.float64(1.714), 'ks_test': np.float64(0.271), 'aic_test': np.float64(352.497), 'bic_test': np.float64(395.112)},
                        'PSPL_blend_piE_+--':
                            {'t0': np.float64(2457486.13333), 't0_error': np.float64(1.42619), 'u0': np.float64(0.11776), 'u0_error': np.float64(0.01478), 'tE': np.float64(169.58239), 'tE_error': np.float64(16.3665), 'piEN': np.float64(0.55407), 'piEN_error': np.float64(0.11561), 'piEE': np.float64(0.35381), 'piEE_error': np.float64(0.10583), 'fsource_Gaia_G': np.float64(18273.3667), 'fsource_Gaia_G_error': np.float64(2479.27615), 'ftotal_Gaia_G': np.float64(32482.38444), 'ftotal_Gaia_G_error': np.float64(210.46696), 'fsource_Gaia_BP': np.float64(3963.14049), 'fsource_Gaia_BP_error': np.float64(578.76735), 'ftotal_Gaia_BP': np.float64(7065.21445), 'ftotal_Gaia_BP_error': np.float64(353.82455), 'fsource_Gaia_RP': np.float64(56612.73528), 'fsource_Gaia_RP_error': np.float64(7710.61049), 'ftotal_Gaia_RP': np.float64(101807.16988), 'ftotal_Gaia_RP_error': np.float64(1269.08367), 'fsource_OGLE_I': np.float64(10982.4347), 'fsource_OGLE_I_error': np.float64(1595.8841), 'ftotal_OGLE_I': np.float64(17747.59771), 'ftotal_OGLE_I_error': np.float64(40.56458), 'chi2': np.float64(326.497), 'red_chi2': np.float64(1.784), 'source_magnitude': np.float64(16.745), 'blend_magnitude': "nan", 'source_mag_error': np.float64(8.002), 'blend_mag_error': "nan", 'baseline_magnitude': np.float64(16.121), 'baseline_mag_error': np.float64(167.567), 'fit_covariance': [[2.0340163669556865, 0.0010530684231082426, -1.7822259637062305, -0.1403283642660809, -0.13467154431242653, -335.61093031746657, -107.09853962627894, -73.56701514157751, -25.099774719975333, -1065.6474276628078, -366.06009464957947, 64.82876687415039, -47.45723063221587], [0.001053068423344903, 0.00021847083431835942, -0.23588261242823946, 3.080357534744376e-05, 0.0005353981408275422, 36.164995957979784, 1.0623986036102426, 7.848502637561465, 0.1713705831550436, 111.94698274518288, 3.027524079343299, 17.89179032963147, 0.2114952237104577], [-1.7822259639726765, -0.2358826124281626, 267.8622555482823, -0.07314572996048001, -0.5162875367079464, -39270.536809422236, -1383.6943319078314, -8516.986627338863, -230.15449181446067, -121563.76343200971, -3977.7133979999526, -22165.87324231181, -209.15096673683573], [-0.14032836426590675, 3.080357536430999e-05, -0.07314572997953436, 0.013365252991088539, 0.009945107359230673, 41.59339308433285, 12.696229382165503, 9.023388141388262, 2.771373489047018, 128.15827384618154, 41.905335975053475, 54.73791810283018, 3.6063018772165263], [-0.1346715443117893, 0.0005353981408437422, -0.5162875367263992, 0.009945107359197184, 0.011200506504320995, 122.87187681708356, 10.3918406247546, 26.68916618462374, 2.2608101604340605, 380.7953977182518, 34.132344502064505, 39.17973252798548, 4.012494899256309], [-335.61093027768413, 36.16499595803898, -39270.5368095018, 41.59339308154068, 122.87187681451965, 6146810.241410887, 205558.99430780855, 1329751.4367583988, 36275.65335308745, 18974031.881821096, 617906.7851871214, 3031074.486692605, 47145.08484401642], [-107.0985396248385, 1.0623986036238753, -1383.694331923654, 12.696229382072875, 10.3918406246927, 205558.9943097398, 44296.343205208876, 45690.44020697477, 3989.754316893301, 652141.9334149592, 62776.87139860181, 177877.07294151542, 3904.500200354805], [-73.5670151329571, 7.8485026375743665, -8516.98662735619, 9.023388140783275, 26.68916618406838, 1329751.4367584113, 45690.44020655673, 334971.64421906695, -15274.85350831724, 4117831.1855873265, 133801.69708825406, 656881.5036328445, 10238.573199523633], [-25.099774719723694, 0.1713705831582029, -230.15449181810473, 2.771373489031417, 2.2608101604253563, 36275.653353556125, 3989.754316898086, -15274.853508215814, 125191.80877345655, 112061.60619089309, 12635.514065740543, 31396.204789551943, 840.4319313209083], [-1065.647427539647, 111.94698274536941, -121563.76343225972, 128.15827383754015, 380.79539771032324, 18974031.881821644, 652141.9334090002, 4117831.1855874057, 112061.6061894457, 59453514.10931485, 1631356.1682316088, 9372724.30169499, 146048.7838614667], [-366.06009464538636, 3.0275240793892855, -3977.7133980531603, 41.905335974788535, 34.132344501901244, 617906.785193811, 62776.87139864043, 133801.69708970253, 12635.514065733421, 1631356.1682522604, 1610573.3544198596, 527276.7881083281, 12757.513742712326], [64.82876689595486, 17.89179032963741, -22165.873242325608, 54.73791810127941, 39.179732526507934, 3031074.4866881547, 177877.0729402956, 656881.5036318733, 31396.20478926668, 9372724.30168091, 527276.7881041922, 2546846.0463484656, 16580.75626793833], [-47.457230631964514, 0.21149522371619495, -209.15096674337613, 3.6063018772028927, 4.012494899254592, 47145.084844917896, 3904.5002003752275, 10238.573199718896, 840.4319313236415, 146048.78386425407, 12757.51374276502, 16580.756268460755, 1645.4853514045776]], 'fit_parameters': OrderedDict([('t0', [0, [np.float64(2456910.4676960483), np.float64(2458202.89675)]]), ('u0', [1, [0.0, 2.0]]), ('tE', [2, [1.0, 3000.0]]), ('piEN', [3, [-2.0, 2.0]]), ('piEE', [4, [-2.0, 2.0]]), ('fsource_Gaia_G', [5, (0.0, np.float64(33755.75602572047))]), ('ftotal_Gaia_G', [6, (0, np.float64(33755.75602572047))]), ('fsource_Gaia_BP', [7, (0.0, np.float64(7337.170544004541))]), ('ftotal_Gaia_BP', [8, (0, np.float64(7337.170544004541))]), ('fsource_Gaia_RP', [9, (0.0, np.float64(105673.7819930607))]), ('ftotal_Gaia_RP', [10, (0, np.float64(105673.7819930607))]), ('fsource_OGLE_I', [11, (0.0, np.float64(17848.42916498003))]), ('ftotal_OGLE_I', [12, (0, np.float64(17848.42916498003))])]), 'sw_test': np.float64(0.875), 'ad_test': np.float64(1.714), 'ks_test': np.float64(0.271), 'aic_test': np.float64(352.497), 'bic_test': np.float64(395.112)},
                        'PSPL_blend_piE_+-+':
                            {'t0': np.float64(2457486.13333), 't0_error': np.float64(1.42619), 'u0': np.float64(0.11776), 'u0_error': np.float64(0.01478), 'tE': np.float64(169.58239), 'tE_error': np.float64(16.3665), 'piEN': np.float64(0.55407), 'piEN_error': np.float64(0.11561), 'piEE': np.float64(0.35381), 'piEE_error': np.float64(0.10583), 'fsource_Gaia_G': np.float64(18273.3667), 'fsource_Gaia_G_error': np.float64(2479.27615), 'ftotal_Gaia_G': np.float64(32482.38444), 'ftotal_Gaia_G_error': np.float64(210.46696), 'fsource_Gaia_BP': np.float64(3963.14049), 'fsource_Gaia_BP_error': np.float64(578.76735), 'ftotal_Gaia_BP': np.float64(7065.21445), 'ftotal_Gaia_BP_error': np.float64(353.82455), 'fsource_Gaia_RP': np.float64(56612.73528), 'fsource_Gaia_RP_error': np.float64(7710.61049), 'ftotal_Gaia_RP': np.float64(101807.16988), 'ftotal_Gaia_RP_error': np.float64(1269.08367), 'fsource_OGLE_I': np.float64(10982.4347), 'fsource_OGLE_I_error': np.float64(1595.8841), 'ftotal_OGLE_I': np.float64(17747.59771), 'ftotal_OGLE_I_error': np.float64(40.56458), 'chi2': np.float64(326.497), 'red_chi2': np.float64(1.784), 'source_magnitude': np.float64(16.745), 'blend_magnitude': "nan", 'source_mag_error': np.float64(8.002), 'blend_mag_error': "nan", 'baseline_magnitude': np.float64(16.121), 'baseline_mag_error': np.float64(167.567), 'fit_covariance': [[2.0340163669556865, 0.0010530684231082426, -1.7822259637062305, -0.1403283642660809, -0.13467154431242653, -335.61093031746657, -107.09853962627894, -73.56701514157751, -25.099774719975333, -1065.6474276628078, -366.06009464957947, 64.82876687415039, -47.45723063221587], [0.001053068423344903, 0.00021847083431835942, -0.23588261242823946, 3.080357534744376e-05, 0.0005353981408275422, 36.164995957979784, 1.0623986036102426, 7.848502637561465, 0.1713705831550436, 111.94698274518288, 3.027524079343299, 17.89179032963147, 0.2114952237104577], [-1.7822259639726765, -0.2358826124281626, 267.8622555482823, -0.07314572996048001, -0.5162875367079464, -39270.536809422236, -1383.6943319078314, -8516.986627338863, -230.15449181446067, -121563.76343200971, -3977.7133979999526, -22165.87324231181, -209.15096673683573], [-0.14032836426590675, 3.080357536430999e-05, -0.07314572997953436, 0.013365252991088539, 0.009945107359230673, 41.59339308433285, 12.696229382165503, 9.023388141388262, 2.771373489047018, 128.15827384618154, 41.905335975053475, 54.73791810283018, 3.6063018772165263], [-0.1346715443117893, 0.0005353981408437422, -0.5162875367263992, 0.009945107359197184, 0.011200506504320995, 122.87187681708356, 10.3918406247546, 26.68916618462374, 2.2608101604340605, 380.7953977182518, 34.132344502064505, 39.17973252798548, 4.012494899256309], [-335.61093027768413, 36.16499595803898, -39270.5368095018, 41.59339308154068, 122.87187681451965, 6146810.241410887, 205558.99430780855, 1329751.4367583988, 36275.65335308745, 18974031.881821096, 617906.7851871214, 3031074.486692605, 47145.08484401642], [-107.0985396248385, 1.0623986036238753, -1383.694331923654, 12.696229382072875, 10.3918406246927, 205558.9943097398, 44296.343205208876, 45690.44020697477, 3989.754316893301, 652141.9334149592, 62776.87139860181, 177877.07294151542, 3904.500200354805], [-73.5670151329571, 7.8485026375743665, -8516.98662735619, 9.023388140783275, 26.68916618406838, 1329751.4367584113, 45690.44020655673, 334971.64421906695, -15274.85350831724, 4117831.1855873265, 133801.69708825406, 656881.5036328445, 10238.573199523633], [-25.099774719723694, 0.1713705831582029, -230.15449181810473, 2.771373489031417, 2.2608101604253563, 36275.653353556125, 3989.754316898086, -15274.853508215814, 125191.80877345655, 112061.60619089309, 12635.514065740543, 31396.204789551943, 840.4319313209083], [-1065.647427539647, 111.94698274536941, -121563.76343225972, 128.15827383754015, 380.79539771032324, 18974031.881821644, 652141.9334090002, 4117831.1855874057, 112061.6061894457, 59453514.10931485, 1631356.1682316088, 9372724.30169499, 146048.7838614667], [-366.06009464538636, 3.0275240793892855, -3977.7133980531603, 41.905335974788535, 34.132344501901244, 617906.785193811, 62776.87139864043, 133801.69708970253, 12635.514065733421, 1631356.1682522604, 1610573.3544198596, 527276.7881083281, 12757.513742712326], [64.82876689595486, 17.89179032963741, -22165.873242325608, 54.73791810127941, 39.179732526507934, 3031074.4866881547, 177877.0729402956, 656881.5036318733, 31396.20478926668, 9372724.30168091, 527276.7881041922, 2546846.0463484656, 16580.75626793833], [-47.457230631964514, 0.21149522371619495, -209.15096674337613, 3.6063018772028927, 4.012494899254592, 47145.084844917896, 3904.5002003752275, 10238.573199718896, 840.4319313236415, 146048.78386425407, 12757.51374276502, 16580.756268460755, 1645.4853514045776]], 'fit_parameters': OrderedDict([('t0', [0, [np.float64(2456910.4676960483), np.float64(2458202.89675)]]), ('u0', [1, [0.0, 2.0]]), ('tE', [2, [1.0, 3000.0]]), ('piEN', [3, [-2.0, 2.0]]), ('piEE', [4, [-2.0, 2.0]]), ('fsource_Gaia_G', [5, (0.0, np.float64(33755.75602572047))]), ('ftotal_Gaia_G', [6, (0, np.float64(33755.75602572047))]), ('fsource_Gaia_BP', [7, (0.0, np.float64(7337.170544004541))]), ('ftotal_Gaia_BP', [8, (0, np.float64(7337.170544004541))]), ('fsource_Gaia_RP', [9, (0.0, np.float64(105673.7819930607))]), ('ftotal_Gaia_RP', [10, (0, np.float64(105673.7819930607))]), ('fsource_OGLE_I', [11, (0.0, np.float64(17848.42916498003))]), ('ftotal_OGLE_I', [12, (0, np.float64(17848.42916498003))])]), 'sw_test': np.float64(0.875), 'ad_test': np.float64(1.714), 'ks_test': np.float64(0.271), 'aic_test': np.float64(352.497), 'bic_test': np.float64(395.112)},
                        'PSPL_blend_piE_++-':
                            {'t0': np.float64(2457486.13333), 't0_error': np.float64(1.42619), 'u0': np.float64(0.11776), 'u0_error': np.float64(0.01478), 'tE': np.float64(169.58239), 'tE_error': np.float64(16.3665), 'piEN': np.float64(0.55407), 'piEN_error': np.float64(0.11561), 'piEE': np.float64(0.35381), 'piEE_error': np.float64(0.10583), 'fsource_Gaia_G': np.float64(18273.3667), 'fsource_Gaia_G_error': np.float64(2479.27615), 'ftotal_Gaia_G': np.float64(32482.38444), 'ftotal_Gaia_G_error': np.float64(210.46696), 'fsource_Gaia_BP': np.float64(3963.14049), 'fsource_Gaia_BP_error': np.float64(578.76735), 'ftotal_Gaia_BP': np.float64(7065.21445), 'ftotal_Gaia_BP_error': np.float64(353.82455), 'fsource_Gaia_RP': np.float64(56612.73528), 'fsource_Gaia_RP_error': np.float64(7710.61049), 'ftotal_Gaia_RP': np.float64(101807.16988), 'ftotal_Gaia_RP_error': np.float64(1269.08367), 'fsource_OGLE_I': np.float64(10982.4347), 'fsource_OGLE_I_error': np.float64(1595.8841), 'ftotal_OGLE_I': np.float64(17747.59771), 'ftotal_OGLE_I_error': np.float64(40.56458), 'chi2': np.float64(326.497), 'red_chi2': np.float64(1.784), 'source_magnitude': np.float64(16.745), 'blend_magnitude': "nan", 'source_mag_error': np.float64(8.002), 'blend_mag_error': "nan", 'baseline_magnitude': np.float64(16.121), 'baseline_mag_error': np.float64(167.567), 'fit_covariance': [[2.0340163669556865, 0.0010530684231082426, -1.7822259637062305, -0.1403283642660809, -0.13467154431242653, -335.61093031746657, -107.09853962627894, -73.56701514157751, -25.099774719975333, -1065.6474276628078, -366.06009464957947, 64.82876687415039, -47.45723063221587], [0.001053068423344903, 0.00021847083431835942, -0.23588261242823946, 3.080357534744376e-05, 0.0005353981408275422, 36.164995957979784, 1.0623986036102426, 7.848502637561465, 0.1713705831550436, 111.94698274518288, 3.027524079343299, 17.89179032963147, 0.2114952237104577], [-1.7822259639726765, -0.2358826124281626, 267.8622555482823, -0.07314572996048001, -0.5162875367079464, -39270.536809422236, -1383.6943319078314, -8516.986627338863, -230.15449181446067, -121563.76343200971, -3977.7133979999526, -22165.87324231181, -209.15096673683573], [-0.14032836426590675, 3.080357536430999e-05, -0.07314572997953436, 0.013365252991088539, 0.009945107359230673, 41.59339308433285, 12.696229382165503, 9.023388141388262, 2.771373489047018, 128.15827384618154, 41.905335975053475, 54.73791810283018, 3.6063018772165263], [-0.1346715443117893, 0.0005353981408437422, -0.5162875367263992, 0.009945107359197184, 0.011200506504320995, 122.87187681708356, 10.3918406247546, 26.68916618462374, 2.2608101604340605, 380.7953977182518, 34.132344502064505, 39.17973252798548, 4.012494899256309], [-335.61093027768413, 36.16499595803898, -39270.5368095018, 41.59339308154068, 122.87187681451965, 6146810.241410887, 205558.99430780855, 1329751.4367583988, 36275.65335308745, 18974031.881821096, 617906.7851871214, 3031074.486692605, 47145.08484401642], [-107.0985396248385, 1.0623986036238753, -1383.694331923654, 12.696229382072875, 10.3918406246927, 205558.9943097398, 44296.343205208876, 45690.44020697477, 3989.754316893301, 652141.9334149592, 62776.87139860181, 177877.07294151542, 3904.500200354805], [-73.5670151329571, 7.8485026375743665, -8516.98662735619, 9.023388140783275, 26.68916618406838, 1329751.4367584113, 45690.44020655673, 334971.64421906695, -15274.85350831724, 4117831.1855873265, 133801.69708825406, 656881.5036328445, 10238.573199523633], [-25.099774719723694, 0.1713705831582029, -230.15449181810473, 2.771373489031417, 2.2608101604253563, 36275.653353556125, 3989.754316898086, -15274.853508215814, 125191.80877345655, 112061.60619089309, 12635.514065740543, 31396.204789551943, 840.4319313209083], [-1065.647427539647, 111.94698274536941, -121563.76343225972, 128.15827383754015, 380.79539771032324, 18974031.881821644, 652141.9334090002, 4117831.1855874057, 112061.6061894457, 59453514.10931485, 1631356.1682316088, 9372724.30169499, 146048.7838614667], [-366.06009464538636, 3.0275240793892855, -3977.7133980531603, 41.905335974788535, 34.132344501901244, 617906.785193811, 62776.87139864043, 133801.69708970253, 12635.514065733421, 1631356.1682522604, 1610573.3544198596, 527276.7881083281, 12757.513742712326], [64.82876689595486, 17.89179032963741, -22165.873242325608, 54.73791810127941, 39.179732526507934, 3031074.4866881547, 177877.0729402956, 656881.5036318733, 31396.20478926668, 9372724.30168091, 527276.7881041922, 2546846.0463484656, 16580.75626793833], [-47.457230631964514, 0.21149522371619495, -209.15096674337613, 3.6063018772028927, 4.012494899254592, 47145.084844917896, 3904.5002003752275, 10238.573199718896, 840.4319313236415, 146048.78386425407, 12757.51374276502, 16580.756268460755, 1645.4853514045776]], 'fit_parameters': OrderedDict([('t0', [0, [np.float64(2456910.4676960483), np.float64(2458202.89675)]]), ('u0', [1, [0.0, 2.0]]), ('tE', [2, [1.0, 3000.0]]), ('piEN', [3, [-2.0, 2.0]]), ('piEE', [4, [-2.0, 2.0]]), ('fsource_Gaia_G', [5, (0.0, np.float64(33755.75602572047))]), ('ftotal_Gaia_G', [6, (0, np.float64(33755.75602572047))]), ('fsource_Gaia_BP', [7, (0.0, np.float64(7337.170544004541))]), ('ftotal_Gaia_BP', [8, (0, np.float64(7337.170544004541))]), ('fsource_Gaia_RP', [9, (0.0, np.float64(105673.7819930607))]), ('ftotal_Gaia_RP', [10, (0, np.float64(105673.7819930607))]), ('fsource_OGLE_I', [11, (0.0, np.float64(17848.42916498003))]), ('ftotal_OGLE_I', [12, (0, np.float64(17848.42916498003))])]), 'sw_test': np.float64(0.875), 'ad_test': np.float64(1.714), 'ks_test': np.float64(0.271), 'aic_test': np.float64(352.497), 'bic_test': np.float64(395.112)},
                        'PSPL_blend_piE_+++':
                            {'t0': np.float64(2457486.13333), 't0_error': np.float64(1.42619), 'u0': np.float64(0.11776), 'u0_error': np.float64(0.01478), 'tE': np.float64(169.58239), 'tE_error': np.float64(16.3665), 'piEN': np.float64(0.55407), 'piEN_error': np.float64(0.11561), 'piEE': np.float64(0.35381), 'piEE_error': np.float64(0.10583), 'fsource_Gaia_G': np.float64(18273.3667), 'fsource_Gaia_G_error': np.float64(2479.27615), 'ftotal_Gaia_G': np.float64(32482.38444), 'ftotal_Gaia_G_error': np.float64(210.46696), 'fsource_Gaia_BP': np.float64(3963.14049), 'fsource_Gaia_BP_error': np.float64(578.76735), 'ftotal_Gaia_BP': np.float64(7065.21445), 'ftotal_Gaia_BP_error': np.float64(353.82455), 'fsource_Gaia_RP': np.float64(56612.73528), 'fsource_Gaia_RP_error': np.float64(7710.61049), 'ftotal_Gaia_RP': np.float64(101807.16988), 'ftotal_Gaia_RP_error': np.float64(1269.08367), 'fsource_OGLE_I': np.float64(10982.4347), 'fsource_OGLE_I_error': np.float64(1595.8841), 'ftotal_OGLE_I': np.float64(17747.59771), 'ftotal_OGLE_I_error': np.float64(40.56458), 'chi2': np.float64(326.497), 'red_chi2': np.float64(1.784), 'source_magnitude': np.float64(16.745), 'blend_magnitude': "nan", 'source_mag_error': np.float64(8.002), 'blend_mag_error': "nan", 'baseline_magnitude': np.float64(16.121), 'baseline_mag_error': np.float64(167.567), 'fit_covariance': [[2.0340163669556865, 0.0010530684231082426, -1.7822259637062305, -0.1403283642660809, -0.13467154431242653, -335.61093031746657, -107.09853962627894, -73.56701514157751, -25.099774719975333, -1065.6474276628078, -366.06009464957947, 64.82876687415039, -47.45723063221587], [0.001053068423344903, 0.00021847083431835942, -0.23588261242823946, 3.080357534744376e-05, 0.0005353981408275422, 36.164995957979784, 1.0623986036102426, 7.848502637561465, 0.1713705831550436, 111.94698274518288, 3.027524079343299, 17.89179032963147, 0.2114952237104577], [-1.7822259639726765, -0.2358826124281626, 267.8622555482823, -0.07314572996048001, -0.5162875367079464, -39270.536809422236, -1383.6943319078314, -8516.986627338863, -230.15449181446067, -121563.76343200971, -3977.7133979999526, -22165.87324231181, -209.15096673683573], [-0.14032836426590675, 3.080357536430999e-05, -0.07314572997953436, 0.013365252991088539, 0.009945107359230673, 41.59339308433285, 12.696229382165503, 9.023388141388262, 2.771373489047018, 128.15827384618154, 41.905335975053475, 54.73791810283018, 3.6063018772165263], [-0.1346715443117893, 0.0005353981408437422, -0.5162875367263992, 0.009945107359197184, 0.011200506504320995, 122.87187681708356, 10.3918406247546, 26.68916618462374, 2.2608101604340605, 380.7953977182518, 34.132344502064505, 39.17973252798548, 4.012494899256309], [-335.61093027768413, 36.16499595803898, -39270.5368095018, 41.59339308154068, 122.87187681451965, 6146810.241410887, 205558.99430780855, 1329751.4367583988, 36275.65335308745, 18974031.881821096, 617906.7851871214, 3031074.486692605, 47145.08484401642], [-107.0985396248385, 1.0623986036238753, -1383.694331923654, 12.696229382072875, 10.3918406246927, 205558.9943097398, 44296.343205208876, 45690.44020697477, 3989.754316893301, 652141.9334149592, 62776.87139860181, 177877.07294151542, 3904.500200354805], [-73.5670151329571, 7.8485026375743665, -8516.98662735619, 9.023388140783275, 26.68916618406838, 1329751.4367584113, 45690.44020655673, 334971.64421906695, -15274.85350831724, 4117831.1855873265, 133801.69708825406, 656881.5036328445, 10238.573199523633], [-25.099774719723694, 0.1713705831582029, -230.15449181810473, 2.771373489031417, 2.2608101604253563, 36275.653353556125, 3989.754316898086, -15274.853508215814, 125191.80877345655, 112061.60619089309, 12635.514065740543, 31396.204789551943, 840.4319313209083], [-1065.647427539647, 111.94698274536941, -121563.76343225972, 128.15827383754015, 380.79539771032324, 18974031.881821644, 652141.9334090002, 4117831.1855874057, 112061.6061894457, 59453514.10931485, 1631356.1682316088, 9372724.30169499, 146048.7838614667], [-366.06009464538636, 3.0275240793892855, -3977.7133980531603, 41.905335974788535, 34.132344501901244, 617906.785193811, 62776.87139864043, 133801.69708970253, 12635.514065733421, 1631356.1682522604, 1610573.3544198596, 527276.7881083281, 12757.513742712326], [64.82876689595486, 17.89179032963741, -22165.873242325608, 54.73791810127941, 39.179732526507934, 3031074.4866881547, 177877.0729402956, 656881.5036318733, 31396.20478926668, 9372724.30168091, 527276.7881041922, 2546846.0463484656, 16580.75626793833], [-47.457230631964514, 0.21149522371619495, -209.15096674337613, 3.6063018772028927, 4.012494899254592, 47145.084844917896, 3904.5002003752275, 10238.573199718896, 840.4319313236415, 146048.78386425407, 12757.51374276502, 16580.756268460755, 1645.4853514045776]], 'fit_parameters': OrderedDict([('t0', [0, [np.float64(2456910.4676960483), np.float64(2458202.89675)]]), ('u0', [1, [0.0, 2.0]]), ('tE', [2, [1.0, 3000.0]]), ('piEN', [3, [-2.0, 2.0]]), ('piEE', [4, [-2.0, 2.0]]), ('fsource_Gaia_G', [5, (0.0, np.float64(33755.75602572047))]), ('ftotal_Gaia_G', [6, (0, np.float64(33755.75602572047))]), ('fsource_Gaia_BP', [7, (0.0, np.float64(7337.170544004541))]), ('ftotal_Gaia_BP', [8, (0, np.float64(7337.170544004541))]), ('fsource_Gaia_RP', [9, (0.0, np.float64(105673.7819930607))]), ('ftotal_Gaia_RP', [10, (0, np.float64(105673.7819930607))]), ('fsource_OGLE_I', [11, (0.0, np.float64(17848.42916498003))]), ('ftotal_OGLE_I', [12, (0, np.float64(17848.42916498003))])]), 'sw_test': np.float64(0.875), 'ad_test': np.float64(1.714), 'ks_test': np.float64(0.271), 'aic_test': np.float64(352.497), 'bic_test': np.float64(395.112)}}
}

class testFitAnalyst:
    '''
    Class with tests
    '''
    def __init__(self,
                 scenario):
        self.scenario = scenario

    def test_parse_config(self):
        from MFPipeline.analyst.fit_analyst import FitAnalyst

        config = {}
        config["event_name"] = self.scenario.get("event_name")
        path_outputs = self.scenario.get("path_outputs")
        config["ra"], config["dec"] = self.scenario.get("ra"), self.scenario.get("dec")
        config["fit_analyst"] = {}
        dict = self.scenario.get("fit_analyst")
        config["fit_analyst"]["fitting_package"] = dict.get("fitting_package")
        config["light_curves"] = self.scenario.get("light_curves")

        light_curves = []
        for entry in config["light_curves"]:
            survey = entry["survey"]
            band = entry["band"]
            if ("path" in entry):
                light_curve = np.genfromtxt(entry["path"], unpack=True)
                light_curves.append((config["event_name"], light_curve, survey, band))
            elif ("lc" in entry):
                light_curve = entry["lc"]
                light_curves.append((config["event_name"], light_curve, survey, band))

        log = logs.start_log(path_outputs, 'debug', event_name=config["event_name"], stream=True)
        analyst = FitAnalyst(config["event_name"], path_outputs, light_curves, log, config_dict=config)
        f_pack_config = analyst.config["fit_analyst"]["fitting_package"]
        logs.close_log(log)

        assert f_pack_config == dict.get("fitting_package")

    def test_check_ongoing(self):
        from MFPipeline.analyst.fit_analyst import FitAnalyst

        config = {}
        config["event_name"] = self.scenario.get("event_name")
        path_outputs = self.scenario.get("path_outputs")
        config["ra"], config["dec"] = self.scenario.get("ra"), self.scenario.get("dec")
        config["fit_analyst"] = {}
        dict = self.scenario.get("fit_analyst")
        config["fit_analyst"]["fitting_package"] = dict.get("fitting_package")
        config["light_curves"] = self.scenario.get("light_curves")

        light_curves = []
        for entry in config["light_curves"]:
            survey = entry["survey"]
            band = entry["band"]
            if ("path" in entry):
                light_curve = np.genfromtxt(entry["path"], unpack=True)
                light_curves.append((config["event_name"], light_curve, survey, band))
            elif ("lc" in entry):
                light_curve = entry["lc"]
                light_curves.append((config["event_name"], light_curve, survey, band))

        log = logs.start_log(path_outputs, 'debug', event_name=config["event_name"], stream=False)
        analyst = FitAnalyst(config["event_name"], path_outputs, light_curves, log, config_dict=config)
        status = analyst.perform_ongoing_check()
        logs.close_log(log)

        assert status == False

    def test_fit(self):
        from MFPipeline.analyst.fit_analyst import FitAnalyst

        config = {}
        config["event_name"] = self.scenario.get("event_name")
        path_outputs = self.scenario.get("path_outputs")
        config["ra"], config["dec"] = self.scenario.get("ra"), self.scenario.get("dec")
        config["fit_analyst"] = {}
        dict = self.scenario.get("fit_analyst")
        config["fit_analyst"]["fitting_package"] = dict.get("fitting_package")
        config["light_curves"] = self.scenario.get("light_curves")

        light_curves = []
        for entry in config["light_curves"]:
            survey = entry["survey"]
            band = entry["band"]
            if ("path" in entry):
                light_curve = np.genfromtxt(entry["path"], unpack=True)
                light_curves.append((config["event_name"], light_curve, survey, band))
            elif ("lc" in entry):
                light_curve = entry["lc"]
                light_curves.append((config["event_name"], light_curve, survey, band))

        log = logs.start_log(path_outputs, 'debug', event_name=config["event_name"], stream=False)
        analyst = FitAnalyst(config["event_name"], path_outputs, light_curves, log, config_dict=config)
        result = analyst.perform_fit()
        with open(path_outputs+"/fit_result.json", "w", encoding="utf-8") as file:
            json.dump(result, file, ensure_ascii=False, indent=4)
        logs.close_log(log)

        expected_fit_result = self.scenario.get("fit_result")
        for model in expected_fit_result:
            model_result = result[model]
            expected_result = expected_fit_result[model]
            assert pytest.approx(model_result["t0"], 2) == pytest.approx(expected_result["t0"], 2)




def test_run():
    case = scenario_gaia
    test = testFitAnalyst(case)
    test.test_parse_config()
    test.test_check_ongoing()
    test.test_fit()